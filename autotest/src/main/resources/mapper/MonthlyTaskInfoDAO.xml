<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.tdw.dao.MonthlyTaskInfoDAO">

    <sql id="MonthlyTaskInfoColumn">
		id,tracker_id,month_task_count,month_task_amount,month_repay_count,month_repay_count_percent,month_repay_amount,month_repay_amount_percent,add_date,
		remark,create_time,update_time,is_deleted
	</sql>


    <select id="queryTaskInfoByAddDate" resultType="cn.tdw.dto.TaskInfoDTO">

       SELECT
        id,
        tracker_id,
        month_task_count AS taskAcount,
        month_task_amount AS taskAmount,
        month_repay_count AS repayCount,
        month_repay_count_percent AS  repayCountPercent,
        month_repay_amount AS repayAmount,
        month_repay_amount_percent AS repayAmountPercent,
        add_date,
		remark,
		create_time,
		update_time,
		is_deleted
        from monthly_task_info where add_date=#{addDate}
    </select>

    <insert id="batchInsertTaskInfo">
        INSERT INTO monthly_task_info(
        tracker_id,
        month_task_count,
        month_task_amount,
        month_repay_count,
        month_repay_count_percent,
        month_repay_amount,
        month_repay_amount_percent,
        add_date

        )VALUES
        <foreach collection="list" item="item" separator=",">
            (#{item.trackerId},
            #{item.taskCount},
            #{item.taskAmount},
            #{item.repayCount},
            #{item.repayCountPercent},
            #{item.repayAmount},
            #{item.repayAmountPercent},
            #{item.addDate})
        </foreach>

    </insert>

    <update id="batchUpdateTaskInfo">
        <foreach collection="list" item="item" separator=";">
            UPDATE  monthly_task_info SET

            month_task_count=#{item.taskCount},
            month_task_amount=#{item.taskAmount},
            month_repay_count=#{item.repayCount},
            month_repay_count_percent=#{item.repayCountPercent},
            month_repay_amount=#{item.repayAmount},
            month_repay_amount_percent=#{item.repayAmountPercent}
            <where>
                AND add_date=#{item.addDate}
                AND tracker_id =#{item.trackerId}
            </where>
        </foreach>

    </update>

</mapper>